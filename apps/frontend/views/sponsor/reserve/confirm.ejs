<%- include('../../common/reserve/_step') %>

<h1 class="pagetitle"><%- __('h1.ConfirmReservation') %></h1>
<p class="guidetext"><%- __('Label.ConfirmReservationGuideTextNoPayment') %></p>

<div class="wrapper-confirm">

    <h2>座席情報</h2>
    <table class="table table-confirm">
        <tbody>

            <tr>
                <th><%- __('Label.FilmName') %>
                    <p class="visible-mobile-block">
                        <a class="btn btn-default btn-change btn-icon-back" href="<%- url('sponsor.reserve.performances', {token: reservationModel.token}) %>">
                            <span><%- __('Button.Change') %></span>
                        </a>
                    </p>
                </th>
                <td>
                    <p><%- reservationModel.performance.film.name[locale] %></p>
                    <a class="btn btn-default btn-change btn-icon-back visible-pc" href="<%- url('sponsor.reserve.performances', {token: reservationModel.token}) %>">
                        <span><%- __('Button.Change') %></span>
                    </a>
                </td>
            </tr>

            <tr>
                <th><%- __('Label.PerformanceTime') %>/<%- __('Label.PerformancePlace') %></th>
                <td>
                    <p>
                        <%- reservationModel.performance.day %> <%- reservationModel.performance.start_time %> ～ 
                        <%- reservationModel.performance.theater.name[locale] %> 
                        <%- reservationModel.performance.screen.name[locale] %>
                    </p>
                </td>
            </tr>

            <tr>
                <th>
                    <%- __('Label.SeatCode') %>/<%- __('Label.TicketType') %>
                    <p class="visible-mobile-block">
                        <a class="btn btn-default btn-change btn-icon-back" href="<%- url('sponsor.reserve.seats', {token: reservationModel.token}) %>"><span><%- __('Button.Change') %></span></a>
                    </p>
                </th>
                <td>
                    <p>
                        <% reservationModel.seatCodes.forEach((seatCode) => { %>
                            <% let reservation = new Models.Reservation(reservationModel.seatCode2reservationDocument(seatCode)); %>
                            <%- reservation.get('seat_code') %> / <%- reservation.get(`ticket_type_detail_str_${locale}`).replace(/\\/g, '&yen;') %>
                            <br>
                        <% }) %>
                    </p>
                    <a class="btn btn-default btn-change btn-icon-back visible-pc" href="<%- url('sponsor.reserve.seats', {token: reservationModel.token}) %>">
                        <span><%- __('Button.Change') %></span>
                    </a>
                </td>
            </tr>

            <% if (reservationModel.getTotalCharge() > 0) { %>
            <tr>
                <th>
                    <%- __('Label.TotalPrice') %>
                </th>
                <td>
                    <p>
                        <span class="price"><%- __('{{price}} yen', {price: numeral(reservationModel.getTotalCharge()).format('0,0')}) %></span>
                    </p>
                </td>
            </tr>
            <% } %>

        </tbody>
    </table>


    <h2>
        <%- __('h3.Profile') %>
        <a class="btn btn-default btn-change btn-icon-back" href="<%- url('sponsor.reserve.profile', {token: reservationModel.token}) %>">
            <span><%- __('Button.Change') %></span>
        </a>
    </h2>
    <table class="table table-confirm">
        <tbody>

            <tr>
                <th><%- __('Label.FullName') %></th>
                <td>
                    <p><%- reservationModel.purchaserLastName %> <%- reservationModel.purchaserFirstName %></p>
                </td>
            </tr>


            <tr>
                <th><%- __('Label.Email') %></th>
                <td>
                    <p><%- reservationModel.purchaserEmail %></p>
                </td>
            </tr>

            <tr>
                <th><%- __('Label.Tel') %></th>
                <td>
                    <p><%- reservationModel.purchaserTel %></p>
                </td>
            </tr>

        </tbody>
    </table>
</div>

<div class="wrapper-notice">
    <h2><%- __('Label.ConfirmNotes') %></h2>
    <p><%- __('ConfirmNotesText') %></p>
</div>

<div class="btns2clm">
    <a class="btn btn-lg btn-next" href="javascript:void(0);"><span><%- __('Button.Next') %></span></a>
    <a class="btn btn-lg btn-back" href="<%- url('sponsor.reserve.profile', {token: req.params.token}) %>"><span><%- __('Button.Back') %></span></a>
</div>

<script>
$(function(){
    $('.btn-next').on('click', function(){
        var form = $('<form/>', {'method': 'post'}); // location.hrefにpostする
        form.appendTo(document.body);
        form.submit();
    });

});
</script>
